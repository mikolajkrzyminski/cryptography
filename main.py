from PowBin import PowBin
from Euclides import Euclides
from FermatTest import FermatTest
from EulerTest import EulerTest

if __name__ == '__main__':
    # binary power test
    a = 114490559043126076738153358744966087681953386182425573483404112031815201175394209446530718026054824536822393073768479394115941549919359895111725996451157521700161443180727996657988659990597046662665463765926411024939606661260667863176902524560156078905991604769638931779122326545032024160910696661027
    b = 391391460710934952447744356920347432818302403303325591886976492807319896968025226937614034635791513888335717473023250182271798945302849615194243154049546831368896945330379987670475241933068594152537330597969762722659261563190456905695749170316137931922395119952663460471204126820352679225013665046771
    Nmod = 393847041276178206491396243212274945872070776985043237184044451747690284405703994938020592656894726519747568678264497623311685635604918597230323269556886420453871930400418329075629418384691272372863859327955756407280218398219170544142787007265395975232901233778590659508114573048528189504436995545652
    c = 136303257957567362180071863636420766740669873324815196184034294705354418812626605831316860686015856673269382516040894551675802604410505265303234064953051343202752741826293797958136947453648897824494945677908997979786647384071102426570472930873744456035769594023808125989650002754112369780914075033671
    #print(PowBin.powBinMod(a, b, Nmod) == c)
    # extended Euclides test
    d = 176437173273670446116561773124856132384693892713711071096077602942883563667648684471246702996573458494081467444229761890204265536548016946836362236321342627584322874302358626492381458968833918927624598808439534606403278344951731148436509537871103713405150203371182245606458112707138645694736668802999
    #print(d == Euclides.extendEuclides(a, Nmod)[0])

    # Fermat test
    #print(FermatTest.getRandomNBitsNumber(4))
    #print(FermatTest.FermatTest(100, 100000002181))
    primeCheck1 = 3213876088517980551083924184682325205044405987565585670602439
    primeCheck2 = 3213876088517980551083924184682325205044405987565585670602429
    #print(FermatTest.FermatTest(100, primeCheck1))
    #print(FermatTest.FermatTest(100, primeCheck2))

    # Euler Test (nie dzia≈Ça dla danych testowych)
    p1 = 557447646341221346636192772896901610558710893835414944403480118710131817164269282839046936145176310843035027195369552947724772574976124889744487830405662539681582010111238770266408227840530530562128937575104894419356210796751265695974980542800695284666417470596597594320307059087588663353662759831219
    a1 = 391391460710934952447744356920347432818302403303325591886976492807319896968025226937614034635791513888335717473023250182271798945302849615194243154049546831368896945330379987670475241933068594152537330597969762722659261563190456905695749170316137931922395119952663460471204126820352679225013665046771
    a2 = 393847041276178206491396243212274945872070776985043237184044451747690284405703994938020592656894726519747568678264497623311685635604918597230323269556886420453871930400418329075629418384691272372863859327955756407280218398219170544142787007265395975232901233778590659508114573048528189504436995545652
    #print(EulerTest.eulerTest(a2, p1))

    p3 = 7
    a3 = 2
    #print(EulerTest.eulerTest(a3, p3))
    #print(EulerTest.squareMod(a3, p3))
    #print("----------prime check---------")

    #aPrime1 = 557447646341221346636192772896901610558710893835414944403480118710131817164269282839046936145176310843035027195369552947724772574976124889744487830405662539681582010111238770266408227840530530562128937575104894419356210796751265695974980542800695284666417470596597594320307059087588663353662759831219
    #bPrime1 = 557447646341221346636192772896901610558710893835414944403480118710131817164269282839046936145176310843035027195369552947724772574976124889744487830405662539681582010111238770266408227840530530562128937575104894419356210796751265695974980542800695284666417470596597594320307059087588663353662759832753

    #print("a: " + str(FermatTest.FermatTest(100, aPrime1)))
    #print("b: " + str(FermatTest.FermatTest(100, bPrime1)))

    pElg = 6262263371377541559141206895621884814807915303145516042650825916222136098970293814810224532254572606923485012865464653542596037422501455912488470111758490086095137370045391054577237580171284636282615725496568360590261691887179088064684821943355507214597667739684622993519703639685862165456606534344947
    xElg = 1831848944654438578680931843323781967581951359544432469465859793716377126588722692849486241121314279763178719116053330559415007978747231329088425724769619907558118568416619870417918752065421786996731037566984329764120000127110604671799692639001148712141410776812882409354267203252047876023101514203171
    c1Elg = 4930490882687076116085929823448518556524926336621082524571007069499319395855324296502235437445967934932787521600599107532531078194796843391952627184815516623257150401617528223084265470741645331148385802788497019587076927091538268120958170365588158668012464348961057111168929144800733802189147469833339
    c2Elg = 1320778616639746095525730330254407469921408577233897503987468020505370909557234769852635541377723891236681125391568276272644732373241015100686633081535309319866887351174142276504736818002775011538657454525452322932342497332733737438842353481743010298952515756561095990344099481063406400709632171512866
    invC1 = Euclides.getInv(c1Elg, pElg)
    powInvC1 = PowBin.powBinMod(invC1, xElg, pElg)
    resultM = (c2Elg * powInvC1) % pElg
    print(resultM)
